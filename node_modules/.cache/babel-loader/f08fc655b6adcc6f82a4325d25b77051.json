{"ast":null,"code":"import _toConsumableArray from\"/Users/oleg/Desktop/prakticum/react-mesto-auth/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _slicedToArray from\"/Users/oleg/Desktop/prakticum/react-mesto-auth/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React from\"react\";import Header from\"./Header\";import Main from\"./Main\";import Footer from\"./Footer\";import ImagePopup from\"./ImagePopup\";import PopupWithForm from\"./PopupWithForm\";import EditProfilePopup from\"./EditProfilePopup\";import EditAvatarPopup from\"./EditAvatarPopup\";import AddPlacePopup from\"./AddPlacePopup\";import newApi from\"../utils/api\";import{CurrentUserContext}from\"../contexts/CurrentUserContext\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function App(){var _React$useState=React.useState(false),_React$useState2=_slicedToArray(_React$useState,2),isEditAvatarPopupOpen=_React$useState2[0],setIsEditAvatarPopupOpen=_React$useState2[1];var _React$useState3=React.useState(false),_React$useState4=_slicedToArray(_React$useState3,2),isEditProfilePopupOpen=_React$useState4[0],setIsEditProfilePopupOpen=_React$useState4[1];var _React$useState5=React.useState(false),_React$useState6=_slicedToArray(_React$useState5,2),isAddPlacePopupOpen=_React$useState6[0],setIsAddPlacePopupOpen=_React$useState6[1];var _React$useState7=React.useState(null),_React$useState8=_slicedToArray(_React$useState7,2),selectedCard=_React$useState8[0],setCard=_React$useState8[1];var _React$useState9=React.useState({name:'',about:'',avatar:''}),_React$useState10=_slicedToArray(_React$useState9,2),currentUser=_React$useState10[0],setCurrentUser=_React$useState10[1];var _React$useState11=React.useState([]),_React$useState12=_slicedToArray(_React$useState11,2),cards=_React$useState12[0],setCards=_React$useState12[1];function handleCardLike(card){// Снова проверяем, есть ли уже лайк на этой карточке\nvar isLiked=card.likes.some(function(i){return i._id===currentUser._id;});// Отправляем запрос в API и получаем обновлённые данные карточки\nnewApi.changeLikeCardStatus(card._id,!isLiked).then(function(newCard){setCards(function(state){return state.map(function(c){return c._id===card._id?newCard:c;});});}).catch(function(err){console.log('error',err);});}function handleCardDelete(card){newApi.deleteCard(card._id).then(function(){setCards(function(state){return state.filter(function(c){return c._id!==card._id;});});}).catch(function(err){console.log('error',err);});}React.useEffect(function(){newApi.getInitialCards().then(function(data){setCards(data);}).catch(function(err){console.log('error',err);});},[]);React.useEffect(function(){newApi.getProfileInfo().then(function(data){setCurrentUser(data);}).catch(function(err){console.log('error',err);});},[]);function handleEditAvatarClick(){setIsEditAvatarPopupOpen(true);}function handleEditProfileClick(){setIsEditProfilePopupOpen(true);}function handleAddPlaceClick(){setIsAddPlacePopupOpen(true);}function handleCardClick(card){setCard(card);}function handleUpdateUser(user){newApi.editProfileInfo(user.name,user.about).then(function(data){setCurrentUser(data);}).catch(function(err){console.log('error',err);});}function handleUpdateAvatar(user){newApi.addNewAvatar(user.avatar).then(function(data){setCurrentUser(data);}).catch(function(err){console.log('error',err);});}function handleAddPlaceSubmit(picture){newApi.addNewCard(picture.name,picture.link).then(function(newCard){setCards([newCard].concat(_toConsumableArray(cards)));}).catch(function(err){console.log('error',err);});}function closeAllPopups(){setIsAddPlacePopupOpen(false);setIsEditAvatarPopupOpen(false);setIsEditProfilePopupOpen(false);setCard(null);}React.useEffect(function(){// закрытие попапа кликом на esc\nfunction handleEscClose(evt){if(evt.key==='Escape'){closeAllPopups();}}window.addEventListener('keydown',handleEscClose);},[]);return/*#__PURE__*/_jsx(CurrentUserContext.Provider,{value:currentUser,children:/*#__PURE__*/_jsx(\"div\",{className:\"root\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"page\",children:[/*#__PURE__*/_jsx(Header,{}),/*#__PURE__*/_jsx(Main,{onEditProfile:handleEditProfileClick,onEditAvatar:handleEditAvatarClick,onAddPlace:handleAddPlaceClick,onCardClick:handleCardClick,cards:cards,onCardLike:handleCardLike,onCardDelete:handleCardDelete}),/*#__PURE__*/_jsx(Footer,{}),/*#__PURE__*/_jsx(EditProfilePopup,{isOpen:isEditProfilePopupOpen,onClose:closeAllPopups,onUpdateUser:handleUpdateUser}),/*#__PURE__*/_jsx(AddPlacePopup,{isOpen:isAddPlacePopupOpen,onClose:closeAllPopups,onAddPlace:handleAddPlaceSubmit}),/*#__PURE__*/_jsx(ImagePopup,{onClose:closeAllPopups,card:selectedCard}),/*#__PURE__*/_jsx(PopupWithForm,{name:\"popup-delete-card\",title:\"\\u0412\\u044B \\u0443\\u0432\\u0435\\u0440\\u0435\\u043D\\u044B?\",children:/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"popup__button popup__button_small popup__button-place\",children:\"\\u0414\\u0430\"})}),/*#__PURE__*/_jsx(EditAvatarPopup,{isOpen:isEditAvatarPopupOpen,onClose:closeAllPopups,onUpdateAvatar:handleUpdateAvatar})]})})});}export default App;","map":{"version":3,"sources":["/Users/oleg/Desktop/prakticum/react-mesto-auth/src/components/App.js"],"names":["React","Header","Main","Footer","ImagePopup","PopupWithForm","EditProfilePopup","EditAvatarPopup","AddPlacePopup","newApi","CurrentUserContext","App","useState","isEditAvatarPopupOpen","setIsEditAvatarPopupOpen","isEditProfilePopupOpen","setIsEditProfilePopupOpen","isAddPlacePopupOpen","setIsAddPlacePopupOpen","selectedCard","setCard","name","about","avatar","currentUser","setCurrentUser","cards","setCards","handleCardLike","card","isLiked","likes","some","i","_id","changeLikeCardStatus","then","newCard","state","map","c","catch","err","console","log","handleCardDelete","deleteCard","filter","useEffect","getInitialCards","data","getProfileInfo","handleEditAvatarClick","handleEditProfileClick","handleAddPlaceClick","handleCardClick","handleUpdateUser","user","editProfileInfo","handleUpdateAvatar","addNewAvatar","handleAddPlaceSubmit","picture","addNewCard","link","closeAllPopups","handleEscClose","evt","key","window","addEventListener"],"mappings":"kVAAA,MAAOA,CAAAA,KAAP,KAAkB,OAAlB,CACA,MAAOC,CAAAA,MAAP,KAAmB,UAAnB,CACA,MAAOC,CAAAA,IAAP,KAAiB,QAAjB,CACA,MAAOC,CAAAA,MAAP,KAAmB,UAAnB,CACA,MAAOC,CAAAA,UAAP,KAAuB,cAAvB,CACA,MAAOC,CAAAA,aAAP,KAA0B,iBAA1B,CACA,MAAOC,CAAAA,gBAAP,KAA6B,oBAA7B,CACA,MAAOC,CAAAA,eAAP,KAA4B,mBAA5B,CACA,MAAOC,CAAAA,aAAP,KAA0B,iBAA1B,CACA,MAAOC,CAAAA,MAAP,KAAmB,cAAnB,CACA,OAAQC,kBAAR,KAAiC,gCAAjC,C,wFAEA,QAASC,CAAAA,GAAT,EAAe,qBAE6CX,KAAK,CAACY,QAAN,CAAe,KAAf,CAF7C,oDAENC,qBAFM,qBAEiBC,wBAFjB,0CAG+Cd,KAAK,CAACY,QAAN,CAAe,KAAf,CAH/C,qDAGNG,sBAHM,qBAGkBC,yBAHlB,0CAIyChB,KAAK,CAACY,QAAN,CAAe,KAAf,CAJzC,qDAINK,mBAJM,qBAIeC,sBAJf,0CAKmBlB,KAAK,CAACY,QAAN,CAAe,IAAf,CALnB,qDAKNO,YALM,qBAKQC,OALR,0CAMyBpB,KAAK,CAACY,QAAN,CAAe,CAACS,IAAI,CAAE,EAAP,CAAWC,KAAK,CAAE,EAAlB,CAAsBC,MAAM,CAAE,EAA9B,CAAf,CANzB,sDAMNC,WANM,sBAMOC,cANP,4CAOazB,KAAK,CAACY,QAAN,CAAe,EAAf,CAPb,uDAONc,KAPM,sBAOCC,QAPD,sBASb,QAASC,CAAAA,cAAT,CAAwBC,IAAxB,CAA8B,CAC5B;AACA,GAAMC,CAAAA,OAAO,CAAGD,IAAI,CAACE,KAAL,CAAWC,IAAX,CAAgB,SAAAC,CAAC,QAAIA,CAAAA,CAAC,CAACC,GAAF,GAAUV,WAAW,CAACU,GAA1B,EAAjB,CAAhB,CACA;AACAzB,MAAM,CAAC0B,oBAAP,CAA4BN,IAAI,CAACK,GAAjC,CAAsC,CAACJ,OAAvC,EACGM,IADH,CACQ,SAACC,OAAD,CAAa,CACnBV,QAAQ,CAAC,SAACW,KAAD,QAAWA,CAAAA,KAAK,CAACC,GAAN,CAAU,SAACC,CAAD,QAAOA,CAAAA,CAAC,CAACN,GAAF,GAAUL,IAAI,CAACK,GAAf,CAAqBG,OAArB,CAA+BG,CAAtC,EAAV,CAAX,EAAD,CAAR,CACD,CAHD,EAIGC,KAJH,CAIS,SAACC,GAAD,CAAS,CACdC,OAAO,CAACC,GAAR,CAAY,OAAZ,CAAqBF,GAArB,EACD,CANH,EAOD,CAED,QAASG,CAAAA,gBAAT,CAA0BhB,IAA1B,CAAgC,CAC9BpB,MAAM,CAACqC,UAAP,CAAkBjB,IAAI,CAACK,GAAvB,EACGE,IADH,CACQ,UAAM,CACZT,QAAQ,CAAC,SAACW,KAAD,QAAWA,CAAAA,KAAK,CAACS,MAAN,CAAa,SAACP,CAAD,QAAOA,CAAAA,CAAC,CAACN,GAAF,GAAUL,IAAI,CAACK,GAAtB,EAAb,CAAX,EAAD,CAAR,CACD,CAHD,EAIGO,KAJH,CAIS,SAACC,GAAD,CAAS,CACdC,OAAO,CAACC,GAAR,CAAY,OAAZ,CAAqBF,GAArB,EACD,CANH,EAOD,CAED1C,KAAK,CAACgD,SAAN,CAAgB,UAAM,CACpBvC,MAAM,CAACwC,eAAP,GACGb,IADH,CACQ,SAACc,IAAD,CAAU,CACdvB,QAAQ,CAACuB,IAAD,CAAR,CACD,CAHH,EAIGT,KAJH,CAIS,SAACC,GAAD,CAAS,CACdC,OAAO,CAACC,GAAR,CAAY,OAAZ,CAAqBF,GAArB,EACD,CANH,EAOD,CARD,CAQG,EARH,EAUA1C,KAAK,CAACgD,SAAN,CAAgB,UAAM,CACpBvC,MAAM,CAAC0C,cAAP,GACGf,IADH,CACQ,SAACc,IAAD,CAAU,CACdzB,cAAc,CAACyB,IAAD,CAAd,CACD,CAHH,EAIGT,KAJH,CAIS,SAACC,GAAD,CAAS,CACdC,OAAO,CAACC,GAAR,CAAY,OAAZ,CAAqBF,GAArB,EACD,CANH,EAOD,CARD,CAQG,EARH,EAWA,QAASU,CAAAA,qBAAT,EAAiC,CAC/BtC,wBAAwB,CAAC,IAAD,CAAxB,CACD,CAED,QAASuC,CAAAA,sBAAT,EAAkC,CAChCrC,yBAAyB,CAAC,IAAD,CAAzB,CACD,CAED,QAASsC,CAAAA,mBAAT,EAA+B,CAC7BpC,sBAAsB,CAAC,IAAD,CAAtB,CACD,CAED,QAASqC,CAAAA,eAAT,CAAyB1B,IAAzB,CAA+B,CAC7BT,OAAO,CAACS,IAAD,CAAP,CACD,CAED,QAAS2B,CAAAA,gBAAT,CAA0BC,IAA1B,CAAgC,CAC9BhD,MAAM,CAACiD,eAAP,CAAuBD,IAAI,CAACpC,IAA5B,CAAkCoC,IAAI,CAACnC,KAAvC,EACGc,IADH,CACQ,SAACc,IAAD,CAAU,CACdzB,cAAc,CAACyB,IAAD,CAAd,CACD,CAHH,EAIGT,KAJH,CAIS,SAACC,GAAD,CAAS,CACdC,OAAO,CAACC,GAAR,CAAY,OAAZ,CAAqBF,GAArB,EACD,CANH,EAOD,CAED,QAASiB,CAAAA,kBAAT,CAA4BF,IAA5B,CAAkC,CAChChD,MAAM,CAACmD,YAAP,CAAoBH,IAAI,CAAClC,MAAzB,EACGa,IADH,CACQ,SAACc,IAAD,CAAU,CACdzB,cAAc,CAACyB,IAAD,CAAd,CACD,CAHH,EAIGT,KAJH,CAIS,SAACC,GAAD,CAAS,CACdC,OAAO,CAACC,GAAR,CAAY,OAAZ,CAAqBF,GAArB,EACD,CANH,EAOD,CAED,QAASmB,CAAAA,oBAAT,CAA8BC,OAA9B,CAAuC,CACrCrD,MAAM,CAACsD,UAAP,CAAkBD,OAAO,CAACzC,IAA1B,CAAgCyC,OAAO,CAACE,IAAxC,EACG5B,IADH,CACQ,SAACC,OAAD,CAAa,CACjBV,QAAQ,EAAEU,OAAF,4BAAcX,KAAd,GAAR,CACD,CAHH,EAIGe,KAJH,CAIS,SAACC,GAAD,CAAS,CACdC,OAAO,CAACC,GAAR,CAAY,OAAZ,CAAqBF,GAArB,EACD,CANH,EAOD,CAED,QAASuB,CAAAA,cAAT,EAA0B,CACxB/C,sBAAsB,CAAC,KAAD,CAAtB,CACAJ,wBAAwB,CAAC,KAAD,CAAxB,CACAE,yBAAyB,CAAC,KAAD,CAAzB,CACAI,OAAO,CAAC,IAAD,CAAP,CACD,CAEDpB,KAAK,CAACgD,SAAN,CAAgB,UAAM,CACpB;AACA,QAASkB,CAAAA,cAAT,CAAwBC,GAAxB,CAA6B,CAC3B,GAAIA,GAAG,CAACC,GAAJ,GAAY,QAAhB,CAA0B,CACxBH,cAAc,GACf,CACF,CACDI,MAAM,CAACC,gBAAP,CAAwB,SAAxB,CAAmCJ,cAAnC,EACD,CARD,CAQG,EARH,EAUA,mBACE,KAAC,kBAAD,CAAoB,QAApB,EAA6B,KAAK,CAAE1C,WAApC,uBACE,YAAK,SAAS,CAAC,MAAf,uBACE,aAAK,SAAS,CAAC,MAAf,wBACE,KAAC,MAAD,IADF,cAEE,KAAC,IAAD,EACE,aAAa,CAAE6B,sBADjB,CAEE,YAAY,CAAED,qBAFhB,CAGE,UAAU,CAAEE,mBAHd,CAIE,WAAW,CAAEC,eAJf,CAKE,KAAK,CAAE7B,KALT,CAME,UAAU,CAAEE,cANd,CAOE,YAAY,CAAEiB,gBAPhB,EAFF,cAWE,KAAC,MAAD,IAXF,cAYE,KAAC,gBAAD,EAAkB,MAAM,CAAE9B,sBAA1B,CACkB,OAAO,CAAEkD,cAD3B,CAEkB,YAAY,CAAET,gBAFhC,EAZF,cAeE,KAAC,aAAD,EAAe,MAAM,CAAEvC,mBAAvB,CACe,OAAO,CAAEgD,cADxB,CAEe,UAAU,CAAEJ,oBAF3B,EAfF,cAmBE,KAAC,UAAD,EAAY,OAAO,CAAEI,cAArB,CAAqC,IAAI,CAAE9C,YAA3C,EAnBF,cAqBE,KAAC,aAAD,EAAe,IAAI,CAAC,mBAApB,CAAwC,KAAK,CAAC,0DAA9C,uBACE,eAAQ,IAAI,CAAC,QAAb,CAAsB,SAAS,CAAC,uDAAhC,0BADF,EArBF,cAyBE,KAAC,eAAD,EAAiB,MAAM,CAAEN,qBAAzB,CAAgD,OAAO,CAAEoD,cAAzD,CACiB,cAAc,CAAEN,kBADjC,EAzBF,GADF,EADF,EADF,CAkCD,CAED,cAAehD,CAAAA,GAAf","sourcesContent":["import React from \"react\";\nimport Header from \"./Header\";\nimport Main from \"./Main\";\nimport Footer from \"./Footer\";\nimport ImagePopup from \"./ImagePopup\";\nimport PopupWithForm from \"./PopupWithForm\";\nimport EditProfilePopup from \"./EditProfilePopup\";\nimport EditAvatarPopup from \"./EditAvatarPopup\";\nimport AddPlacePopup from \"./AddPlacePopup\";\nimport newApi from \"../utils/api\";\nimport {CurrentUserContext} from \"../contexts/CurrentUserContext\";\n\nfunction App() {\n\n  const [isEditAvatarPopupOpen, setIsEditAvatarPopupOpen] = React.useState(false);\n  const [isEditProfilePopupOpen, setIsEditProfilePopupOpen] = React.useState(false);\n  const [isAddPlacePopupOpen, setIsAddPlacePopupOpen] = React.useState(false);\n  const [selectedCard, setCard] = React.useState(null);\n  const [currentUser, setCurrentUser] = React.useState({name: '', about: '', avatar: ''});\n  const [cards, setCards] = React.useState([]);\n\n  function handleCardLike(card) {\n    // Снова проверяем, есть ли уже лайк на этой карточке\n    const isLiked = card.likes.some(i => i._id === currentUser._id);\n    // Отправляем запрос в API и получаем обновлённые данные карточки\n    newApi.changeLikeCardStatus(card._id, !isLiked)\n      .then((newCard) => {\n      setCards((state) => state.map((c) => c._id === card._id ? newCard : c));\n    })\n      .catch((err) => {\n        console.log('error', err)\n      })\n  }\n\n  function handleCardDelete(card) {\n    newApi.deleteCard(card._id)\n      .then(() => {\n      setCards((state) => state.filter((c) => c._id !== card._id));\n    })\n      .catch((err) => {\n        console.log('error', err)\n      })\n  }\n\n  React.useEffect(() => {\n    newApi.getInitialCards()\n      .then((data) => {\n        setCards(data)\n      })\n      .catch((err) => {\n        console.log('error', err)\n      })\n  }, [])\n\n  React.useEffect(() => {\n    newApi.getProfileInfo()\n      .then((data) => {\n        setCurrentUser(data);\n      })\n      .catch((err) => {\n        console.log('error', err)\n      })\n  }, []);\n\n\n  function handleEditAvatarClick() {\n    setIsEditAvatarPopupOpen(true);\n  }\n\n  function handleEditProfileClick() {\n    setIsEditProfilePopupOpen(true);\n  }\n\n  function handleAddPlaceClick() {\n    setIsAddPlacePopupOpen(true);\n  }\n\n  function handleCardClick(card) {\n    setCard(card);\n  }\n\n  function handleUpdateUser(user) {\n    newApi.editProfileInfo(user.name, user.about)\n      .then((data) => {\n        setCurrentUser(data);\n      })\n      .catch((err) => {\n        console.log('error', err)\n      })\n  }\n\n  function handleUpdateAvatar(user) {\n    newApi.addNewAvatar(user.avatar)\n      .then((data) => {\n        setCurrentUser(data);\n      })\n      .catch((err) => {\n        console.log('error', err)\n      })\n  }\n\n  function handleAddPlaceSubmit(picture) {\n    newApi.addNewCard(picture.name, picture.link)\n      .then((newCard) => {\n        setCards([newCard, ...cards]);\n      })\n      .catch((err) => {\n        console.log('error', err)\n      })\n  }\n\n  function closeAllPopups() {\n    setIsAddPlacePopupOpen(false);\n    setIsEditAvatarPopupOpen(false);\n    setIsEditProfilePopupOpen(false);\n    setCard(null)\n  }\n\n  React.useEffect(() => {\n    // закрытие попапа кликом на esc\n    function handleEscClose(evt) {\n      if (evt.key === 'Escape') {\n        closeAllPopups();\n      }\n    }\n    window.addEventListener('keydown', handleEscClose);\n  }, [])\n\n  return (\n    <CurrentUserContext.Provider value={currentUser}>\n      <div className=\"root\">\n        <div className=\"page\">\n          <Header/>\n          <Main\n            onEditProfile={handleEditProfileClick}\n            onEditAvatar={handleEditAvatarClick}\n            onAddPlace={handleAddPlaceClick}\n            onCardClick={handleCardClick}\n            cards={cards}\n            onCardLike={handleCardLike}\n            onCardDelete={handleCardDelete}\n          />\n          <Footer/>\n          <EditProfilePopup isOpen={isEditProfilePopupOpen}\n                            onClose={closeAllPopups}\n                            onUpdateUser={handleUpdateUser}/>\n          <AddPlacePopup isOpen={isAddPlacePopupOpen}\n                         onClose={closeAllPopups}\n                         onAddPlace={handleAddPlaceSubmit}/>\n\n          <ImagePopup onClose={closeAllPopups} card={selectedCard}/>\n\n          <PopupWithForm name=\"popup-delete-card\" title=\"Вы уверены?\">\n            <button type=\"submit\" className=\"popup__button popup__button_small popup__button-place\">Да</button>\n          </PopupWithForm>\n\n          <EditAvatarPopup isOpen={isEditAvatarPopupOpen} onClose={closeAllPopups}\n                           onUpdateAvatar={handleUpdateAvatar}/>\n        </div>\n      </div>\n    </CurrentUserContext.Provider>\n  );\n}\n\nexport default App;\n"]},"metadata":{},"sourceType":"module"}